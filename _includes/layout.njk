<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="msvalidate.01" content="E2912AF201C363D2A52C70A60E5F4311" />

    {# --- Google AdSense Verification --- #}
    <meta name="google-adsense-account" content="ca-pub-4748186290410675">

    {# --- Google Consent Mode v2 & Analytics --- #}
    {# This MUST load before any other tracking scripts #}
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      
      // 1. Default consent to 'denied' immediately
      gtag('consent', 'default', {
        'ad_storage': 'denied',
        'ad_user_data': 'denied',
        'ad_personalization': 'denied',
        'analytics_storage': 'denied',
        'wait_for_update': 500
      });
    </script>

    {# 2. Load Google Analytics (Production Only) #}
{% if env.environment == "production" %}
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-47ZV9G37SY"></script>
    <script>
      gtag('js', new Date());
      gtag('config', 'G-47ZV9G37SY');
    </script>
{% endif %}

    {# 3. Google AdSense Engine (Loads once for the whole page) #}
    {# Wrapped to prevent ads from loading on localhost #}
    {% if env.environment == "production" %}
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4748186290410675"
          crossorigin="anonymous"></script>
    {% endif %}

    {# --- Canonical helpers --- #}
    {% set canonical_path = canonical or page.url %}
    {% set canonical_abs = (site.url or '') + canonical_path %}

    <title>{% block title %}{{ title or 'FGC Top Players' }}{% endblock %}</title>

    {% block meta_description %}
    <meta name="description" content="The definitive player rankings for top competitive fighting games. Track pro players across Street Fighter, Tekken, and more." />
    {% endblock %}

    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ canonical_abs }}">
    <meta property="og:title" content="{% block og_title %}{{ title or 'FGC Top Players' }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}The definitive ranking of top professional fighting game players. See who's on top and track your favorite pros.{% endblock %}">
    {# --- Social / Open Graph Images --- #}
    {# Logic: Use page-specific image if available, otherwise use default social card #}
    {% set socialImage = image or '/images/fgc-top-players-social-card.png' %}

    <meta property="og:image" content="{{ site.url }}{{ socialImage }}">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@FGCTopPlayers">
    <meta name="twitter:url" content="{{ canonical_abs }}">
    <meta name="twitter:title" content="{% block twitter_title %}{{ title or 'FGC Global Player Rankings' }}{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}The definitive ranking of top professional fighting game players. See who's on top and track your favorite pros.{% endblock %}">
    <meta name="twitter:image" content="{{ site.url }}{{ socialImage }}">

    {# --- Canonical --- #}
    {% block canonical %}
    <link rel="canonical" href="{{ canonical_abs }}" />
    {% endblock %}

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"></noscript>

    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"></noscript>

    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">

    <link rel="icon" type="image/png" sizes="192x192" href="/images/favicon.png" />
    <link rel="shortcut icon" href="/images/favicon.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
    <meta name="theme-color" content="#FF5E13" />

    <script src="/js/main.js" defer></script>

    {% block head_extra %}{% endblock %}
    {% block structured_data %}{% endblock %}
    {% block head %}{% endblock %}
</head>
<body class="{{ bodyClass or '' }}">

    <a href="#maincontent" class="skip-link">Skip to main content</a>

    <header class="mobile-header">
        <button class="nav-toggle" aria-label="Toggle Navigation" aria-expanded="false">
            <span class="hamburger-icon">
                <span></span>
                <span></span>
                <span></span>
            </span>
        </button>
        <div class="mobile-search">
            {% set inputId = "mobile-search-input" %}
            {% include "partials/_search-form.njk" %}
        </div>
    </header>

    <nav class="mobile-nav" aria-label="Mobile menu" id="mobile-nav">
        <div class="mobile-nav__header">
            <h2 class="mobile-nav__title">Menu</h2>
            <button class="mobile-nav__close" aria-label="Close navigation" id="mobile-nav-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="mobile-nav__content">
            {% set listClass = "mobile-nav__menu" %}
            {% set navActiveSeed = (eleventyNavigation and eleventyNavigation.key) or navHighlight %}
            {% set navActiveTrail = [] %}
            {% if navActiveSeed %}
                {% set navActiveTrail = collections.all | eleventyNavigationBreadcrumb(navActiveSeed) %}
            {% endif %}
            {% set activeTrail = navActiveTrail %}
            {% set navHighlightKey = navHighlight %}
            {% include "partials/_navigation.njk" %}
        </div>
    </nav>

    <div class="mobile-nav-overlay" id="mobile-nav-overlay"></div>

    <div class="page-wrapper">
        <nav class="sidebar nav-sidebar" aria-label="Main menu" role="navigation">
            <h2 class="sidebar__label">Navigation</h2>
            <div class="sidebar-search">
                {% set inputId = "sidebar-search-input" %}
                {% include "partials/_search-form.njk" %}
            </div>
            {% set listClass = "nav-menu" %}
            {% set navActiveSeed = (eleventyNavigation and eleventyNavigation.key) or navHighlight %}
            {% set navActiveTrail = [] %}
            {% if navActiveSeed %}
                {% set navActiveTrail = collections.all | eleventyNavigationBreadcrumb(navActiveSeed) %}
            {% endif %}
            {% set activeTrail = navActiveTrail %}
            {% set navHighlightKey = navHighlight %}
            {% include "partials/_navigation.njk" %}
        </nav>

        <main class="content" id="maincontent" tabindex="-1" data-pagefind-body>
        {% include "partials/breadcrumbs.njk" %}

            {# --- MANUAL AD: LEADERBOARD --- #}
            <div class="ad-container ad-container--header">
                <span class="ad-label">Advertisement</span>

                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-4748186290410675"
                     data-ad-slot="6905520391"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
            {# ------------------------------ #}

            {% block content %}
    {{ content | autoLink(page, collections, playerProfiles) | safe }}
{% endblock %}

            <footer class="content-footer">
                <div class="footer-columns">
                    <div class="footer-column">
    <h3>Navigation</h3>
    <ul class="footer-links">
        <li><a href="/">Home</a></li>
        <li><a href="/sf6-rankings/">SF6 Rankings</a></li>
        <li><a href="/player-profiles/">Player Profiles</a></li>
        <li><a href="/tournaments/results/">Tournament Results</a></li>
        <li><a href="/analysis/player-stats/">Player Stats</a></li>
        <li><a href="/reference/ranking-system/">Ranking System</a></li>
    </ul>
</div>
                    <div class="footer-column">
                        <h3>Community</h3>
                        <ul class="footer-links">
                            <li><a href="/about/">About Us</a></li>
                            <li><a href="/contribute/">Become a Contributor</a></li>
                            <li><a href="/support/">Support the Site</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Follow Us</h3>
                        <ul class="footer-social">
                            <li><a href="https://x.com/FGCTopPlayers" target="_blank" rel="noopener noreferrer" aria-label="Follow on X"><i class="fab fa-x-twitter"></i></a></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-legal">
                    <p>Â© {% year %} FGC Top Players. An independent community resource not affiliated with Capcom, Bandai Namco, or any game publisher or tournament organizer. All game titles, character names, and trademarks are property of their respective owners and used for informational purposes only. Tournament data provided by <a href="https://www.start.gg" target="_blank" rel="noopener noreferrer">start.gg</a>.</p>

                    <p class="legal-links">
                        <a href="/contact/">Contact</a> |
                        <a href="/terms-of-use/">Terms of Use</a> |
                        <a href="/privacy-policy/">Privacy Policy</a> |
                        {# This link triggers Google's Privacy Menu via cookie-consent.js #}
                        <a href="#" id="footer-cookie-settings">Cookie Settings</a>
                    </p>
                </div>
            </footer>
        </main>
        {% set sidebarVariantValue = sidebarVariant or "events" %}
        {% set sidebarTitleValue = sidebarTitle or "Upcoming Tournaments" %}
        {% set sidebarCountValue = sidebarCount or 3 %}

        <aside class="sidebar right-sidebar" aria-label="Contextual Information">
            
            <h2 class="sidebar__label">{{ sidebarTitleValue }}</h2>

            {# --- MANUAL AD: SIDEBAR --- #}
            <div class="ad-container ad-container--sidebar">
                <span class="ad-label">Advertisement</span>
                
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-4748186290410675"
                     data-ad-slot="8246630028"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
            {# -------------------------- #}

            {% if sidebarVariantValue == "news" %}
                {% set sidebarNewsItems = collections.news | default([]) | reverse %}
                {% if sidebarNewsItems and sidebarNewsItems.length > 0 %}
                    {% for article in sidebarNewsItems %}
                        {% if loop.index0 < sidebarCountValue %}
                            {% include "partials/_home_card.njk" %}
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <p class="sidebar-empty-state">No news articles available right now.</p>
                {% endif %}
            {% else %}
                {% set upcomingEvents = allUpcomingTournaments | values | rejectattr("isArchived", "truthy") | list %}
                {% if upcomingEvents and upcomingEvents.length > 0 %}
                    {% for sidebarEvent in upcomingEvents %}
                        {% if loop.index <= sidebarCountValue %}
                            <a class="sidebar-card-link" href="/upcoming-tournaments/{{ sidebarEvent.slug }}/">
                                <div class="sidebar-event-card event-card--{{ (sidebarEvent.tier | lower) | replace('+', '-plus') }}">
                                    <h3 class="sidebar-event-card__title">{{ sidebarEvent.name }}</h3>

                                    <div class="sidebar-event-card__info">
                                        {% if sidebarEvent.dates %}
                                            <div class="sidebar-event-card__info-row">
                                                <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                                                <span>{{ sidebarEvent.dates }}</span>
                                            </div>
                                        {% endif %}

                                        {% if sidebarEvent.location %}
                                            <div class="sidebar-event-card__info-row">
                                                <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                                                <span>{{ sidebarEvent.location }}</span>
                                            </div>
                                        {% endif %}
                                    </div>

                                    <span class="btn btn--primary btn--small sidebar-event-card__button">
                                        Read More
                                    </span>
                                </div>
                            </a>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <p style="text-align: center; padding: 0 1rem;">No upcoming events at this time.</p>
                {% endif %}
            {% endif %}
        </aside>
    </div>

    <div id="site-search-panel" class="site-search-panel" hidden aria-hidden="true">
        <div class="site-search-panel__inner profile-card profile-card--search" role="dialog" aria-modal="true" aria-labelledby="site-search-title">
            <div class="site-search-panel__header profile-card__header">
                <h2 id="site-search-title" class="site-search-panel__title">Search Results</h2>
                <button type="button" id="site-search-close" class="site-search-panel__close" aria-label="Close search results">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="site-search-panel__results profile-card__body">
                <form id="site-search-refine" class="site-search-refine-form" role="search" novalidate>
                    <label class="sr-only" for="site-search-refine-input">Refine search</label>
                    <div class="site-search-refine__controls">
                            <div class="site-search-refine__input-wrapper">
                                <input
                                    id="site-search-refine-input"
                                    class="site-search-refine__input"
                                    type="text"
                                    autocomplete="off"
                                    spellcheck="false"
                                >
                                <button type="button" id="site-search-clear-btn" class="search-clear-btn" aria-label="Clear search">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <button type="submit" class="site-search-refine__submit">
                                Search
                            </button>
                        </div>
                </form>
                <div id="site-search-status" class="site-search-panel__status" role="status" aria-live="polite" hidden></div>
                <div id="pagefind-search" class="site-search-panel__results-body" data-pagefind></div>
            </div>
        </div>
    </div>

    <noscript>
        <p style="text-align:center;padding:1rem;background:#111;color:#f00;">
            JavaScript is disabled. Some interactive features may not work correctly.
        </p>
    </noscript>

    <button id="back-to-top-btn" class="back-to-top-btn" title="Go to top" aria-label="Go to top">
        <i class="fas fa-chevron-up"></i>
    </button>

    <script type="module" src="/js/siteSearch.js"></script>
    <script src="/js/cookie-consent.js"></script>
    {% block scripts %}{% endblock %}
</body>
</html>